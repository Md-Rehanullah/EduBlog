<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - EduBlog</title>
    <meta name="description" content="Admin dashboard for managing EduBlog content">
    <link rel="stylesheet" href="styles.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <nav class="nav">
            <div class="nav-container">
                <div class="nav-brand">
                    <a href="index.html"><h1>EduBlog</h1></a>
                </div>
                
                <div class="nav-menu" id="nav-menu">
                    <a href="index.html" class="nav-link">Home</a>
                    <a href="about.html" class="nav-link">About</a>
                    <a href="index.html#content" class="nav-link">Content</a>
                    <a href="index.html#contact" class="nav-link">Contact</a>
                    <a href="privacy-policy.html" class="nav-link">Privacy</a>
                    <a href="terms-conditions.html" class="nav-link">Terms</a>
                    <a href="sitemap.html" class="nav-link">Sitemap</a>
                    <a href="dashboard.html" class="nav-link active">Dashboard</a>
                </div>
                
                <button class="nav-toggle" id="nav-toggle">
                    <i class="fas fa-bars"></i>
                </button>
            </div>
        </nav>
    </header>

    <!-- Main Content -->
    <main class="main-content">
        <section class="page-header">
            <div class="container">
                <h1>Dashboard</h1>
                <p>Manage your EduBlog content</p>
            </div>
        </section>

        <section class="dashboard-content">
            <div class="container">
                <div id="dashboard-auth" class="dashboard-auth">
                    <div class="auth-form">
                        <h2>Admin Authentication</h2>
                        <p>Please enter your password to access the dashboard</p>
                        <form id="dashboard-password-form">
                            <div class="form-group">
                                <label for="dashboard-password">Password</label>
                                <input type="password" id="dashboard-password" required>
                            </div>
                            <button type="submit" class="btn btn-primary">Authenticate</button>
                        </form>
                    </div>
                </div>

                <div id="dashboard-main" class="dashboard-main" style="display: none;">
                    <div class="dashboard-actions">
                        <button id="create-new-post" class="btn btn-primary">
                            <i class="fas fa-plus"></i> Create New Post
                        </button>
                        <button id="refresh-posts" class="btn btn-outline">
                            <i class="fas fa-sync-alt"></i> Refresh Posts
                        </button>
                    </div>

                    <div class="posts-list">
                        <h2>Your Posts</h2>
                        <div class="posts-filter">
                            <select id="posts-filter">
                                <option value="all">All Posts</option>
                                <option value="blog">Blogs</option>
                                <option value="story">Stories</option>
                                <option value="news">News</option>
                                <option value="published">Published</option>
                                <option value="drafts">Drafts</option>
                            </select>
                        </div>
                        <div id="posts-container" class="posts-container">
                            <!-- Posts will be loaded here -->
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <!-- Your existing footer content -->
    </footer>

    <!-- Post Editor Modal -->
    <div id="post-editor-modal" class="modal">
        <!-- Modal content for post editing -->
    </div>

    <!-- Confirmation Modal -->
    <div id="confirm-modal" class="modal">
        <!-- Modal content for confirmations -->
    </div>

    <script src="script.js"></script>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Use functions from script.js
        const passwordForm = document.getElementById('dashboard-password-form');
        if (passwordForm) {
            passwordForm.addEventListener('submit', function(e) {
                e.preventDefault();
                const password = document.getElementById('dashboard-password').value;
                if (password === 'admin123') {
                    localStorage.setItem('isAuthenticated', 'true');
                    window.EduBlog.isAuthenticated = true;
                    showDashboard();
                    showToast('Authentication successful!');
                } else {
                    showToast('Incorrect password. Please try again.', 'error');
                }
            });
        }

        function showDashboard() {
            document.getElementById('dashboard-auth').style.display = 'none';
            document.getElementById('dashboard-main').style.display = 'block';
            loadDashboardPosts();
        }

        function loadDashboardPosts(filter = 'all') {
            const postsContainer = document.getElementById('posts-container');
            postsContainer.innerHTML = '<div class="loading"><div class="spinner"></div> Loading posts...</div>';

            // Use posts from the global EduBlog object
            let filteredPosts = [...window.EduBlog.posts];
            
            // Apply filters
            if (filter !== 'all') {
                if (filter === 'published') {
                    filteredPosts = filteredPosts.filter(post => post.isPublished);
                } else if (filter === 'drafts') {
                    filteredPosts = filteredPosts.filter(post => !post.isPublished);
                } else {
                    filteredPosts = filteredPosts.filter(post => post.contentType === filter);
                }
            }

            // Render posts
            postsContainer.innerHTML = '';
            if (filteredPosts.length === 0) {
                postsContainer.innerHTML = '<p class="loading">No posts found.</p>';
            } else {
                filteredPosts.forEach(post => {
                    postsContainer.appendChild(createDashboardPostElement(post));
                });
            }
        }

        function createDashboardPostElement(post) {
            const element = document.createElement('div');
            element.className = 'post-item';
            
            const statusClass = post.isPublished ? 'published' : 'draft';
            const statusText = post.isPublished ? 'Published' : 'Draft';
            
            element.innerHTML = `
                <div class="post-header">
                    <h3>${post.title}</h3>
                    <div class="post-meta">
                        <span class="status ${statusClass}">${statusText}</span>
                        <span>${post.contentType}</span>
                        <span>${new Date(post.publishedAt).toLocaleDateString()}</span>
                    </div>
                </div>
                <div class="post-excerpt">${post.excerpt}</div>
                <div class="post-actions">
                    <button class="btn btn-primary" onclick="window.EduBlog.openPostModal(${post.id})">
                        <i class="fas fa-eye"></i> View
                    </button>
                    <button class="btn btn-outline" onclick="editPost(${post.id})">
                        <i class="fas fa-edit"></i> Edit
                    </button>
                    <button class="btn btn-danger" onclick="deletePost(${post.id})">
                        <i class="fas fa-trash"></i> Delete
                    </button>
                </div>
            `;
            
            return element;
        }

        // Check if already authenticated
        if (window.EduBlog.isAuthenticated) {
            showDashboard();
        }

        // Set up event listeners
        document.getElementById('create-new-post')?.addEventListener('click', function() {
            showCreatePostModal();
        });

        document.getElementById('refresh-posts')?.addEventListener('click', function() {
            loadDashboardPosts(document.getElementById('posts-filter').value);
        });

        document.getElementById('posts-filter')?.addEventListener('change', function() {
            loadDashboardPosts(this.value);
        });
    });
    </script>
</body>
</html>
